#!/usr/bin/python3

'''IGP Render Controller Version 5

This file simplifies starting the controller by allowing the user to choose
which mode (server, GUI client, etc) to run by appending the appropriate
arguments.'''

'''
#####################################################################
Copyright 2014 James Adson

This file is part of IGP Render Controller.  
IGP Render Controller is free software: you can redistribute it 
and/or modify it under the terms of the GNU General Public License 
as published by the Free Software Foundation, either version 3 of 
the License, or any later version.

This program is distributed in the hope that it will be useful,
but WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
GNU General Public License for more details.

You should have received a copy of the GNU General Public License
along with this program.  If not, see <http://www.gnu.org/licenses/>.
#####################################################################
'''

import sys
import server
import gui
import projcache


helptext = (
'IGP Render Controller\n'
'Usage: rcontroller [-s] [-h] [-p] [port#]\n'
'Execute with no options to start the GUI client.\n'
'-s --server\tStart the server.\n'
'-p --port\tUse the specified port when starting the server.\n'
'\t\tMust be used with -s or --server.\n'
'--cache\t\tCopy files to local rendercaches (interactive).\n'
'--retrieve\tRetrieve rendered files from local rendercaches (interactive).\n'
'-h --help\tDisplay this help message.'
)


port = None

if '-s' in sys.argv or '--server' in sys.argv:
    if '-p' in sys.argv or '--port' in sys.argv:
        for i in sys.argv:
            if i.isdigit(): #assume any number in args is the port number
                port = int(i)
                break
    renderserver = server.Server(port=port)
elif '-h' in sys.argv or '--help' in sys.argv:
    print(helptext)
elif '--cache' in sys.argv:
    projcache.Interactive(mode='send')
elif '--retrieve' in sys.argv:
    projcache.Interactive(mode='retrieve')
    
else:
    masterwin = gui.MasterWin()
    masterwin.mainloop()
